# 小红书笔记采集插件 MVP 需求文档

## 1. 产品概述

一款浏览器插件，帮助用户在小红书笔记详情页快速采集笔记信息，并写入用户自己的飞书多维表格。MVP目标是简单可用、支持多用户自定义表格、低清图片和小视频采集，并保存用户飞书配置供多次使用。

---

## 2. 用户使用场景

1. 用户在浏览器打开小红书笔记详情页。
2. 插件自动检测笔记信息，包括标题、作者、正文、标签、点赞/收藏/评论、低清图片/视频。
3. 用户在插件面板中填写备注信息。
4. 用户可在插件中配置飞书表格（Access Token、表格 ID、列映射），配置保存到浏览器本地，可多次使用。
5. 点击“采集”，插件将信息和文件上传到飞书多维表格。
6. 用户在飞书表格中查看已采集的笔记数据。

---

## 3. 用户流程（文字形式）

1. **打开小红书笔记页**
   - 用户打开笔记详情页，插件自动检测页面是否为笔记详情页，并弹出操作面板。

2. **输入备注信息**
   - 用户在面板中填写备注，插件显示数据待采集区。

3. **配置飞书表格**
   - 用户输入 Access Token、表格 ID 和列映射，并保存到本地存储。
   - 配置长期保存，可多次采集使用。

4. **选择采集配置**
   - 用户可从已保存配置中选择使用，默认使用选择的配置进行采集。

5. **点击采集按钮**
   - 插件进行 DOM 采集笔记信息，抓取低清图片/视频。
   - 调用飞书文件上传接口获取文件 ID。
   - 组装 JSON 数据写入多维表格。

6. **采集完成提示**
   - 弹窗提示“采集成功”，用户可继续浏览下一条笔记。
   - 数据可在飞书表格中查看和管理。

7. **管理配置（可选）**
   - 用户可新增、修改或删除保存的配置，采集可灵活切换。

---

## 4. 功能需求

### 核心功能

- 页面检测：判断当前是否为笔记详情页。
- DOM采集：抓取标题、作者、正文、标签、互动数据、低清图片/视频。
- 用户备注：用户可填写自定义备注信息。
- 飞书表格配置：用户可输入 Access Token、表格 ID、列映射，并长期保存到本地存储。
- 配置管理：支持多套配置，用户可新增、修改、删除或选择使用。
- 文件上传：将低清图片/视频上传到飞书文件接口。
- 数据写入表格：组装 JSON 数据写入多维表格。
- 提示与异常处理：采集成功/失败提示，DOM节点找不到时跳过。

### 辅助功能

- 选择器配置管理：插件内置 DOM 选择器，后续可更新插件版本维护。
- 本地存储配置：长期保存用户飞书表格信息，支持多次采集使用。

---

## 5. 技术实现要点

- 前端：Chrome/Edge 插件（Manifest V3 + HTML/JS/CSS）
- DOM采集：`document.querySelector` 或更稳健的选择器
- 文件处理：将图片/视频转成 Blob/Base64，调用飞书文件上传接口
- 飞书表格写入：POST 请求 API，含文本字段和文件 ID
- 用户配置存储：Chrome 本地存储（`chrome.storage.local`），支持多配置管理
- 错误容错：节点不存在或上传失败不崩溃，提示用户

---

## 6. 潜在风险与注意点

- DOM依赖小红书前端结构，页面改版可能导致采集失效 → 插件需更新。
- 视频或大图片上传可能卡顿 → MVP阶段限制低清和小文件。
- Access Token 安全 → 插件不存服务器，用户自行提供。
- 批量采集可能影响浏览器性能 → MVP阶段仅支持单条笔记采集。
