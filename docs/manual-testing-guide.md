# 手动测试指南

本文档提供了Chrome扩展存储问题修复后的完整手动测试流程。

## 测试环境准备

### 系统要求
- Chrome浏览器 88+
- 稳定的网络连接
- 飞书账号和开发者权限

### 测试前准备
1. **构建扩展**:
   ```bash
   pnpm build
   ```

2. **清理旧数据**:
   - 在Chrome扩展管理页面卸载旧版本
   - 清除浏览器缓存和Cookie

3. **准备测试账号**:
   - 飞书开发者账号
   - 测试用多维表格
   - 应用凭证（App ID, Secret, Access Token）

## 测试流程

### 阶段1: 扩展安装测试

#### 1.1 扩展加载测试
**目的**: 验证扩展能否正常安装和加载

**步骤**:
1. 打开Chrome扩展管理页面 (`chrome://extensions/`)
2. 开启"开发者模式"
3. 点击"加载已解压的扩展程序"
4. 选择 `dist` 目录
5. 观察扩展是否正常显示

**预期结果**:
- 扩展图标正常显示
- 无错误提示
- 扩展详情页显示正常

#### 1.2 权限检查测试
**目的**: 验证扩展权限是否正确配置

**步骤**:
1. 在扩展管理页面点击扩展详情
2. 查看"权限"部分
3. 验证以下权限存在：
   - 存储 (storage)
   - 标签页 (tabs)
   - 活动标签页 (activeTab)
   - 脚本注入 (scripting)

**预期结果**:
- 所有必要权限都已授予
- 权限描述正确显示

### 阶段2: 初始化测试

#### 2.1 Background Script初始化测试
**目的**: 验证后台脚本能否正常初始化

**步骤**:
1. 打开扩展管理页面
2. 点击"服务工作线程"查看后台脚本
3. 点击"检查"打开开发者工具
4. 观察Console输出

**预期结果**:
```
✅ 扩展初始化完成
配置加载成功，包含 X 个飞书配置
✅ 系统健康检查通过
```

#### 2.2 Popup初始化测试
**目的**: 验证弹窗能否正常初始化

**步骤**:
1. 点击扩展图标打开弹窗
2. 观察状态指示器
3. 查看Console输出（右键弹窗 -> 检查）

**预期结果**:
- 状态指示器显示"系统就绪"
- Console显示初始化成功消息
- 无JavaScript错误

#### 2.3 存储系统测试
**目的**: 验证存储系统是否正常工作

**步骤**:
1. 在Popup Console中执行：
   ```javascript
   // 测试存储操作
   chrome.storage.local.set({test: 'value'}, () => {
     console.log('存储测试完成');
   });
   
   chrome.storage.local.get(['test'], (result) => {
     console.log('读取结果:', result);
   });
   ```

**预期结果**:
- 存储操作成功
- 读取结果正确
- 无存储相关错误

### 阶段3: 配置管理测试

#### 3.1 配置界面测试
**目的**: 验证配置界面是否正常工作

**步骤**:
1. 打开扩展弹窗
2. 检查配置输入框：
   - App ID输入框
   - Table ID输入框
   - Access Token输入框
3. 测试输入框功能：
   - 输入文本
   - 删除文本
   - 复制粘贴

**预期结果**:
- 所有输入框响应正常
- 输入验证生效
- 界面布局正确

#### 3.2 配置保存测试
**目的**: 验证配置能否正常保存

**步骤**:
1. 填写测试配置：
   ```
   App ID: cli_test123456
   Table ID: bascn_test123456
   Access Token: pat_test123456
   ```
2. 点击"保存配置"
3. 刷新页面
4. 验证配置是否保留

**预期结果**:
- 配置保存成功提示
- 刷新后配置仍然存在
- Console无存储错误

#### 3.3 配置验证测试
**目的**: 验证配置验证功能

**步骤**:
1. 尝试保存无效配置：
   - 空App ID
   - 无效格式Table ID
   - 空Access Token
2. 观察错误提示
3. 尝试保存有效配置

**预期结果**:
- 无效配置显示正确错误信息
- 有效配置保存成功
- 验证逻辑工作正常

### 阶段4: 连接测试

#### 4.1 连接测试基础功能
**目的**: 验证飞书连接测试功能

**步骤**:
1. 配置有效的飞书凭证
2. 点击"测试连接"按钮
3. 观察连接状态变化
4. 查看Console输出

**预期结果**:
- 连接测试进度显示
- 成功/失败状态正确显示
- 详细的错误信息（如失败）

#### 4.2 网络异常测试
**目的**: 验证网络异常处理

**步骤**:
1. 断开网络连接
2. 点击"测试连接"
3. 观察错误提示
4. 重新连接网络
5. 重新测试连接

**预期结果**:
- 网络断开时显示网络错误
- 恢复后连接测试正常
- 错误信息用户友好

#### 4.3 凭证错误测试
**目的**: 验证无效凭证处理

**步骤**:
1. 使用错误的Access Token
2. 点击"测试连接"
3. 观察错误提示
4. 使用正确的Token重新测试

**预期结果**:
- 错误凭证显示认证失败
- 正确凭证连接成功
- 错误信息具体明确

### 阶段5: 页面检测测试

#### 5.1 页面识别测试
**目的**: 验证小红书页面检测功能

**步骤**:
1. 打开小红书笔记页面（如：`https://www.xiaohongshu.com/explore/xxx`）
2. 打开扩展弹窗
3. 观察页面检测结果
4. 测试非小红书页面

**预期结果**:
- 小红书页面显示"已检测到小红书笔记"
- 非小红书页面显示"当前页面不是小红书笔记页面"
- 页面信息正确显示

#### 5.2 数据采集测试
**目的**: 验证页面数据采集功能

**步骤**:
1. 在小红书笔记页面打开扩展
2. 等待页面数据加载
3. 观察数据预览区域
4. 验证以下字段：
   - 标题
   - 作者
   - 正文
   - 标签
   - 互动数据

**预期结果**:
- 数据预览正确显示
- 字段数据完整
- 数据格式正确

#### 5.3 页面异常测试
**目的**: 验证页面异常处理

**步骤**:
1. 测试加载中的页面
2. 测试错误的页面URL
3. 测试内容异常的页面
4. 观察错误处理

**预期结果**:
- 加载中页面显示"检测中..."
- 错误页面显示友好错误信息
- 无严重错误导致崩溃

### 阶段6: 数据采集测试

#### 6.1 完整采集流程测试
**目的**: 验证完整的数据采集流程

**步骤**:
1. 在小红书笔记页面
2. 确保配置正确且连接测试通过
3. 点击"采集"按钮
4. 观察采集进度和结果

**预期结果**:
- 采集按钮状态变化
- 进度提示正确显示
- 采集成功/失败结果正确
- 飞书表格中数据正确写入

#### 6.2 大数据处理测试
**目的**: 验证大量数据的处理能力

**步骤**:
1. 选择包含大量图片/视频的笔记
2. 执行采集操作
3. 观察处理性能
4. 验证所有数据是否正确处理

**预期结果**:
- 大文件处理正常
- 内存使用合理
- 处理时间可接受
- 所有数据完整保存

#### 6.3 错误恢复测试
**目的**: 验证错误恢复机制

**步骤**:
1. 在采集过程中模拟错误：
   - 网络中断
   - 存储失败
   - 飞书API错误
2. 观察错误处理
3. 验证重试机制

**预期结果**:
- 错误被正确捕获
- 用户收到友好提示
- 自动重试机制工作
- 系统状态保持稳定

### 阶段7: 存储系统健壮性测试

#### 7.1 存储压力测试
**目的**: 验证存储系统的健壮性

**步骤**:
1. 连续多次保存配置
2. 快速切换配置
3. 大量数据存储操作
4. 观察系统表现

**预期结果**:
- 存储操作稳定
- 无数据丢失
- 性能保持稳定
- 无内存泄漏

#### 7.2 存储恢复测试
**目的**: 验证存储恢复机制

**步骤**:
1. 清除扩展数据
2. 重新初始化扩展
3. 验证默认配置生成
4. 测试功能恢复

**预期结果**:
- 系统正常初始化
- 默认配置正确生成
- 功能正常工作
- 数据完整性保持

#### 7.3 加密存储测试
**目的**: 验证加密存储功能

**步骤**:
1. 保存敏感配置（Access Token）
2. 检查存储的数据是否加密
3. 测试数据读取和解密
4. 验证数据安全性

**预期结果**:
- 敏感数据正确加密
- 数据读取正常
- 加密算法工作正常
- 安全性得到保障

### 阶段8: 用户体验测试

#### 8.1 界面响应性测试
**目的**: 验证界面响应性

**步骤**:
1. 测试各种用户操作：
   - 按钮点击
   - 输入框输入
   - 页面切换
2. 观察响应速度
3. 验证加载状态

**预期结果**:
- 界面响应及时
- 加载状态正确显示
- 无卡顿或延迟
- 用户体验流畅

#### 8.2 错误提示测试
**目的**: 验证错误提示的用户友好性

**步骤**:
1. 触发各种错误情况
2. 观察错误提示信息
3. 验证用户理解程度
4. 测试错误恢复操作

**预期结果**:
- 错误信息清晰易懂
- 提供解决方案建议
- 用户操作指引明确
- 错误恢复路径清晰

#### 8.3 多语言支持测试
**目的**: 验证多语言支持

**步骤**:
1. 测试中文界面
2. 验证错误信息本地化
3. 测试配置界面
4. 确认文本显示正确

**预期结果**:
- 中文显示正确
- 无乱码或缺失文本
- 界面布局合理
- 文化适应性良好

## 测试检查清单

### 功能测试清单
- [ ] 扩展正常安装和加载
- [ ] 后台脚本初始化成功
- [ ] 弹窗界面正常显示
- [ ] 存储系统工作正常
- [ ] 配置保存和读取正常
- [ ] 飞书连接测试通过
- [ ] 页面检测功能正常
- [ ] 数据采集功能正常
- [ ] 错误处理机制完善
- [ ] 用户界面响应良好

### 性能测试清单
- [ ] 初始化时间 < 3秒
- [ ] 配置保存时间 < 1秒
- [ ] 连接测试时间 < 5秒
- [ ] 数据采集时间 < 10秒
- [ ] 内存使用 < 50MB
- [ ] 无内存泄漏

### 稳定性测试清单
- [ ] 连续操作无崩溃
- [ ] 异常情况处理正确
- [ ] 数据完整性保证
- [ ] 恢复机制工作正常
- [ ] 并发操作处理正确

## 测试结果记录

### 测试环境
- **浏览器版本**: Chrome XX.X.XXXX.XXX
- **操作系统**: macOS / Windows / Linux
- **扩展版本**: v1.2.0
- **测试日期**: YYYY-MM-DD

### 测试结果汇总
| 测试项目 | 结果 | 备注 |
|---------|------|------|
| 扩展安装 | ✅ 通过 | |
| 初始化测试 | ✅ 通过 | |
| 配置管理 | ✅ 通过 | |
| 连接测试 | ✅ 通过 | |
| 页面检测 | ✅ 通过 | |
| 数据采集 | ✅ 通过 | |
| 存储系统 | ✅ 通过 | |
| 用户体验 | ✅ 通过 | |

### 发现的问题
1. **问题描述**: [具体问题描述]
   **严重程度**: 高/中/低
   **解决方案**: [解决方案]
   **状态**: 已解决/待解决

2. **问题描述**: [具体问题描述]
   **严重程度**: 高/中/低
   **解决方案**: [解决方案]
   **状态**: 已解决/待解决

### 性能指标
- 初始化时间: X.X秒
- 内存使用: XX MB
- 采集成功率: XX%

## 回归测试

### 修复验证
对于每个修复的问题，执行以下验证：

1. **重现问题步骤**
2. **验证修复效果**
3. **确认无副作用**
4. **记录测试结果**

### 回归测试范围
- 核心功能测试
- 边界条件测试
- 异常情况测试
- 性能回归测试

## 测试自动化建议

### 自动化测试脚本
```javascript
// 示例：自动化测试脚本
describe('Chrome扩展测试', () => {
  test('扩展安装测试', async () => {
    // 安装扩展验证
  });
  
  test('配置管理测试', async () => {
    // 配置保存读取验证
  });
  
  test('数据采集测试', async () => {
    // 数据采集流程验证
  });
});
```

### 持续集成
建议设置CI/CD流程，每次代码更新自动运行测试。

## 相关文档

- [Chrome扩展存储问题修复指南](./storage-fix-guide.md)
- [配置示例文档](./configuration-examples.md)
- [技术实现方案](./technical-plan.md)
- [MVP产品需求](./mvp-prd.md)