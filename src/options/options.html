<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°çº¢ä¹¦é‡‡é›†å™¨é…ç½®</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">
  <style>
    .container { 
      max-width: 800px; 
      margin: 2rem auto; 
      padding: 0 1rem; 
    }
    .toast { 
      position: fixed; 
      top: 1rem; 
      right: 1rem;
      padding: 1rem;
      border-radius: 8px;
      color: white;
      font-weight: 500;
      z-index: 1000;
    }
    .toast.success { background: #28a745; }
    .toast.error { background: #dc3545; }
    .toast.hide { display: none; }
    .config-section {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }
    .config-help {
      font-size: 0.875rem;
      color: #6c757d;
      margin-top: 0.5rem;
    }
    .btn-test {
      background: #17a2b8;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 4px;
      cursor: pointer;
      margin-left: 1rem;
    }
    .btn-test:hover {
      background: #138496;
    }
    .status-indicator {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-right: 0.5rem;
    }
    .status-connected { background: #28a745; }
    .status-disconnected { background: #dc3545; }
    .status-testing { background: #ffc107; }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ”§ é£ä¹¦é…ç½®</h1>
      <p>é…ç½®å°çº¢ä¹¦ç¬”è®°é‡‡é›†å™¨çš„é£ä¹¦å¤šç»´è¡¨æ ¼è¿æ¥ä¿¡æ¯</p>
    </header>
    
    <main>
      <section class="config-section">
        <h2>åŸºç¡€é…ç½®</h2>
        <form id="configForm">
          <label for="spreadsheetUrl">
            å¤šç»´è¡¨æ ¼ URL
            <input 
              type="url" 
              id="spreadsheetUrl" 
              name="spreadsheetUrl" 
              required 
              placeholder="https://www.feishu.cn/sheets/xxxxxxxx"
            />
            <div class="config-help">
              ç²˜è´´å®Œæ•´çš„é£ä¹¦å¤šç»´è¡¨æ ¼é“¾æ¥ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è§£æ App Token å’Œ Table ID
            </div>
          </label>
          
          <label for="appId">
            é£ä¹¦åº”ç”¨ App ID
            <input 
              type="text" 
              id="appId" 
              name="appId" 
              required
              placeholder="cli_a1b2c3d4e5f6g7h8"
            />
            <div class="config-help">
              åœ¨é£ä¹¦å¼€æ”¾å¹³å°åˆ›å»ºåº”ç”¨åè·å–çš„ App ID
            </div>
          </label>
          
          <label for="appSecret">
            é£ä¹¦åº”ç”¨ App Secret
            <input 
              type="password" 
              id="appSecret" 
              name="appSecret" 
              required
              placeholder="xxxxxxxxxxxxxxxx"
            />
            <div class="config-help">
              åœ¨é£ä¹¦å¼€æ”¾å¹³å°åº”ç”¨è¯¦æƒ…é¡µè·å–çš„ App Secret
            </div>
          </label>
          
          <div style="margin-top: 2rem;">
            <button type="submit" id="saveBtn">ğŸ’¾ ä¿å­˜é…ç½®</button>
            <button type="button" id="testBtn" class="btn-test">ğŸ”— æµ‹è¯•è¿æ¥</button>
            <span id="connectionStatus" style="margin-left: 1rem;">
              <span class="status-indicator status-disconnected"></span>
              æœªè¿æ¥
            </span>
          </div>
        </form>
      </section>
      
      <section class="config-section">
        <h2>ä½¿ç”¨è¯´æ˜</h2>
        <h3>å¦‚ä½•è·å–é…ç½®ä¿¡æ¯ï¼Ÿ</h3>
        <ol>
          <li><strong>å¤šç»´è¡¨æ ¼ URL</strong>ï¼šæ‰“å¼€é£ä¹¦å¤šç»´è¡¨æ ¼ï¼Œå¤åˆ¶å®Œæ•´çš„æµè§ˆå™¨åœ°å€æ é“¾æ¥</li>
          <li><strong>App ID</strong>ï¼šåœ¨é£ä¹¦å¼€æ”¾å¹³å°åˆ›å»ºåº”ç”¨åï¼Œä»åº”ç”¨å‡­è¯é¡µé¢è·å–</li>
          <li><strong>App Secret</strong>ï¼šåœ¨é£ä¹¦å¼€æ”¾å¹³å°åº”ç”¨è¯¦æƒ…é¡µçš„å‡­è¯ç®¡ç†ä¸­è·å–</li>
        </ol>
        
        <h3>æ”¯æŒçš„URLæ ¼å¼</h3>
        <p>ç³»ç»Ÿæ”¯æŒä»¥ä¸‹é£ä¹¦å¤šç»´è¡¨æ ¼URLæ ¼å¼ï¼Œä¼šè‡ªåŠ¨è§£æApp Tokenå’ŒTable IDï¼š</p>
        
        <h4>æ ¼å¼1ï¼šå¤šç»´è¡¨æ ¼æ ¼å¼ï¼ˆæ¨èï¼‰</h4>
        <pre><code>https://your-domain.feishu.cn/base/APP_TOKEN?table=TABLE_ID</code></pre>
        
        <h4>æ ¼å¼2ï¼šç”µå­è¡¨æ ¼æ ¼å¼</h4>
        <pre><code>https://www.feishu.cn/sheets/APP_TOKEN?table=TABLE_ID</code></pre>
        
        <h4>æ ¼å¼3ï¼šå¸¦è§†å›¾å‚æ•°</h4>
        <pre><code>https://your-domain.feishu.cn/base/APP_TOKEN?table=TABLE_ID&view=VIEW_ID</code></pre>
        
        <p>ç³»ç»Ÿä¼šè‡ªåŠ¨è§£æå¹¶æå–ï¼š</p>
        <ul>
          <li><strong>App Token</strong>ï¼šURLè·¯å¾„ä¸­çš„ <code>APP_TOKEN</code> éƒ¨åˆ†</li>
          <li><strong>è¡¨æ ¼ ID</strong>ï¼šæŸ¥è¯¢å‚æ•°ä¸­çš„ <code>table=TABLE_ID</code> éƒ¨åˆ†</li>
        </ul>
        
        <div class="config-help">
          <strong>æç¤ºï¼š</strong>ç›´æ¥å¤åˆ¶æµè§ˆå™¨åœ°å€æ çš„å®Œæ•´URLå³å¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æå–æ‰€éœ€ä¿¡æ¯ã€‚
        </div>
        
        <h3>é£ä¹¦åº”ç”¨åˆ›å»ºæ­¥éª¤</h3>
        <ol>
          <li>è®¿é—®é£ä¹¦å¼€æ”¾å¹³å° (<code>open.feishu.cn</code>)</li>
          <li>åˆ›å»ºä¼ä¸šè‡ªå»ºåº”ç”¨</li>
          <li>åœ¨æƒé™ç®¡ç†ä¸­æ·»åŠ <strong>å¤šç»´è¡¨æ ¼</strong>ç›¸å…³æƒé™</li>
          <li>è·å– App ID å’Œ App Secret</li>
        </ol>
      </section>
      
      <section class="config-section">
        <h2>é«˜çº§è®¾ç½®</h2>
        <label for="baseUrl">
          é£ä¹¦ API åŸºç¡€ URL
          <input 
            type="text" 
            id="baseUrl" 
            name="baseUrl" 
            value="https://open.feishu.cn"
          />
          <div class="config-help">
            ä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦ä¿®æ”¹ï¼Œé™¤éä½¿ç”¨è‡ªå®šä¹‰API endpoint
          </div>
        </label>
        
        <label for="timeout">
          è¯·æ±‚è¶…æ—¶æ—¶é—´ (æ¯«ç§’)
          <input 
            type="number" 
            id="timeout" 
            name="timeout" 
            value="10000"
            min="1000"
            max="60000"
          />
          <div class="config-help">
            ç½‘ç»œè¯·æ±‚çš„è¶…æ—¶æ—¶é—´ï¼Œå»ºè®®è®¾ç½®ä¸º 10-30 ç§’
          </div>
        </label>
      </section>
    </main>
    
    <footer>
      <div id="toast" class="toast hide"></div>
    </footer>
  </div>
  
  <script src="./options.ts" type="module"></script>
</body>
</html>