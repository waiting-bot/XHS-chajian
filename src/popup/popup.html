<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Â∞èÁ∫¢‰π¶Á¨îËÆ∞ÈááÈõÜÂô®</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="app-container">
    <!-- È°∂ÈÉ®Ê†áÈ¢òÊ†è -->
    <header class="app-header">
      <div class="header-content">
        <div class="app-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7L12 12L22 7L12 2Z"/>
            <path d="M2 17L12 22L22 17"/>
            <path d="M2 12L12 17L22 12"/>
          </svg>
        </div>
        <div class="app-title">
          <h1>Â∞èÁ∫¢‰π¶ÈááÈõÜÂô®</h1>
          <p class="app-subtitle">Êô∫ËÉΩÁ¨îËÆ∞Êï∞ÊçÆÈááÈõÜÂ∑•ÂÖ∑</p>
        </div>
      </div>
    </header>

    <!-- ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü -->
    <main class="app-main">
      <!-- È°µÈù¢Áä∂ÊÄÅÂç°Áâá -->
      <div class="status-card">
        <div class="card-header">
          <div class="status-indicator" id="statusIndicator">
            <div class="indicator-dot loading"></div>
            <span class="status-text">Ê£ÄÊµã‰∏≠...</span>
          </div>
          <div class="card-actions">
            <button class="icon-button" onclick="refreshPageStatus()" title="Âà∑Êñ∞Áä∂ÊÄÅ">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 4v6h6M23 20v-6h-6"/>
                <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
              </svg>
            </button>
          </div>
        </div>
        
        <div class="card-content" id="pageCardContent">
          <div class="loading-state">
            <div class="loading-spinner"></div>
            <p>Ê≠£Âú®ÂàÜÊûêÂΩìÂâçÈ°µÈù¢...</p>
          </div>
          
          <div class="page-info" id="pageInfo" style="display: none;">
            <div class="info-item">
              <div class="info-icon">üìÑ</div>
              <div class="info-details">
                <div class="info-label">Á¨îËÆ∞Ê†áÈ¢ò</div>
                <div class="info-value" id="noteTitle">-</div>
              </div>
            </div>
            <div class="info-item">
              <div class="info-icon">üë§</div>
              <div class="info-details">
                <div class="info-label">‰ΩúËÄÖ</div>
                <div class="info-value" id="noteAuthor">-</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Êï∞ÊçÆÈ¢ÑËßàÂç°Áâá -->
      <div class="preview-card" id="previewCard" style="display: none;">
        <div class="card-header">
          <h3 class="card-title">Êï∞ÊçÆÈ¢ÑËßà</h3>
          <button class="expand-button" onclick="toggleCard('previewContent')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </button>
        </div>
        
        <div class="card-content expanded" id="previewContent">
          <div class="preview-grid" id="previewGrid">
            <!-- Âä®ÊÄÅÁîüÊàêÁöÑÈ¢ÑËßàÂÜÖÂÆπ -->
          </div>
        </div>
      </div>

      <!-- ‰∏ªË¶ÅÊìç‰ΩúÂå∫Âüü -->
      <div class="action-section">
        <button class="primary-button" id="collectBtn" disabled>
          <span class="button-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
            </svg>
          </span>
          <span class="button-text">ÈááÈõÜÊï∞ÊçÆ</span>
        </button>
        
        <button class="secondary-button" id="addNoteBtn" disabled>
          <span class="button-icon">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 20h9"/>
              <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
            </svg>
          </span>
          <span class="button-text">Ê∑ªÂä†Â§áÊ≥®</span>
        </button>
      </div>

      <!-- Â§áÊ≥®ÁºñËæëÂô® -->
      <div class="note-editor" id="noteEditor" style="display: none;">
        <div class="editor-header">
          <h3 class="editor-title">Â§áÊ≥®ÁºñËæëÂô®</h3>
          <button class="close-button" onclick="closeNoteEditor()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        
        <div class="editor-content">
          <div class="input-group">
            <textarea 
              id="noteInput"
              class="modern-textarea"
              placeholder="Âú®ËøôÈáåËæìÂÖ•‰Ω†ÁöÑÂ§áÊ≥®..."
              rows="4"
              maxlength="500"
            ></textarea>
            <div class="input-footer">
              <div class="char-counter">
                <span id="charCount">0</span>
                <span class="max-chars">/ 500</span>
              </div>
              <div class="auto-save-indicator" id="autoSaveIndicator">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M20 6L9 17l-5-5"/>
                </svg>
                <span>Â∑≤Ëá™Âä®‰øùÂ≠ò</span>
              </div>
            </div>
          </div>

          <div class="note-options">
            <div class="category-selector">
              <label class="selector-label">Á±ªÂûã</label>
              <div class="category-pills">
                <label class="category-pill">
                  <input type="radio" name="noteCategory" value="general" checked>
                  <span class="pill-content">üìù ‰∏ÄËà¨</span>
                </label>
                <label class="category-pill">
                  <input type="radio" name="noteCategory" value="priority">
                  <span class="pill-content">‚≠ê ÈáçË¶Å</span>
                </label>
                <label class="category-pill">
                  <input type="radio" name="noteCategory" value="question">
                  <span class="pill-content">‚ùì ÁñëÈóÆ</span>
                </label>
              </div>
            </div>

            <div class="tag-selector">
              <label class="selector-label">Ê†áÁ≠æ</label>
              <div class="tag-chips" id="tagChips">
                <div class="tag-chip" data-tag="ÈáçË¶Å">ÈáçË¶Å</div>
                <div class="tag-chip" data-tag="ÂæÖÂ§ÑÁêÜ">ÂæÖÂ§ÑÁêÜ</div>
                <div class="tag-chip" data-tag="Â∑≤ÂÆ°Ê†∏">Â∑≤ÂÆ°Ê†∏</div>
                <div class="tag-chip" data-tag="ÈúÄË¶ÅË∑üËøõ">ÈúÄË¶ÅË∑üËøõ</div>
              </div>
              <div class="selected-tags" id="selectedTags"></div>
            </div>
          </div>

          <div class="editor-actions">
            <button class="ghost-button" onclick="clearNote()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
              </svg>
              Ê∏ÖÁ©∫
            </button>
            
            <button class="ghost-button" onclick="showNoteHistory()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 20V10M6 20V4M18 20v-6"/>
              </svg>
              ÂéÜÂè≤
            </button>
            
            <button class="primary-button" onclick="saveNote()">
              <span class="button-icon">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                  <polyline points="17 21 17 13 7 13 7 21"/>
                  <polyline points="7 3 7 8 15 8"/>
                </svg>
              </span>
              <span class="button-text">‰øùÂ≠òÂ§áÊ≥®</span>
            </button>
          </div>
        </div>

        <!-- ÂéÜÂè≤ËÆ∞ÂΩïÈù¢Êùø -->
        <div class="history-panel" id="historyPanel" style="display: none;">
          <div class="history-header">
            <h4>Â§áÊ≥®ÂéÜÂè≤</h4>
            <button class="close-button" onclick="hideNoteHistory()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"/>
                <line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
            </button>
          </div>
          <div class="history-list" id="historyList">
            <div class="empty-state">ÊöÇÊó†ÂéÜÂè≤ËÆ∞ÂΩï</div>
          </div>
        </div>
      </div>

      <!-- ÈÖçÁΩÆÈù¢Êùø -->
      <div class="config-card">
        <div class="card-header">
          <h3 class="card-title">È£û‰π¶ÈÖçÁΩÆ</h3>
          <button class="expand-button" onclick="toggleCard('configContent')">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </button>
        </div>
        
        <div class="card-content" id="configContent">
          <div class="config-selector">
            <label class="selector-label">ÈÖçÁΩÆÊñá‰ª∂</label>
            <div class="config-selector-group">
              <select class="modern-select" id="configSelect">
                <option value="">ÊöÇÊó†ÈÖçÁΩÆ</option>
              </select>
              <div class="config-manager-buttons">
                <button class="icon-button" onclick="createNewConfig()" title="Êñ∞Âª∫ÈÖçÁΩÆ">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"/>
                    <line x1="5" y1="12" x2="19" y2="12"/>
                  </svg>
                </button>
                <button class="icon-button" onclick="exportConfig()" title="ÂØºÂá∫ÈÖçÁΩÆ">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="7 10 12 15 17 10"/>
                    <line x1="12" y1="15" x2="12" y2="3"/>
                  </svg>
                </button>
                <button class="icon-button" onclick="importConfig()" title="ÂØºÂÖ•ÈÖçÁΩÆ">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="17 8 12 3 7 8"/>
                    <line x1="12" y1="3" x2="12" y2="15"/>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          
          <div class="config-form">
            <div class="form-field">
              <label class="field-label">ÈÖçÁΩÆÂêçÁß∞</label>
              <input type="text" class="modern-input" id="configName" placeholder="ÊàëÁöÑÈ£û‰π¶ÈÖçÁΩÆ">
            </div>
            
            <div class="form-field">
              <label class="field-label">App ID</label>
              <input type="text" class="modern-input" id="appId" placeholder="cli_a1b2c3d4...">
            </div>
            
            <div class="form-field">
              <label class="field-label">Ë°®Ê†º ID</label>
              <input type="text" class="modern-input" id="tableId" placeholder="tbl_x7y8z9a0...">
            </div>
            
            <div class="form-field">
              <label class="field-label">Access Token</label>
              <div class="password-input">
                <input type="password" class="modern-input" id="accessToken" placeholder="ËØ∑ËæìÂÖ•ËÆøÈóÆ‰ª§Áâå">
                <button class="password-toggle" onclick="togglePassword()">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                    <circle cx="12" cy="12" r="3"/>
                  </svg>
                </button>
              </div>
            </div>
            
            <div class="config-actions">
              <button class="secondary-button" onclick="testConnection()">
                <span class="button-icon">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>
                  </svg>
                </span>
                <span class="button-text">ÊµãËØïËøûÊé•</span>
              </button>
              
              <button class="primary-button" onclick="saveConfig()">
                <span class="button-icon">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                    <polyline points="17 21 17 13 7 13 7 21"/>
                    <polyline points="7 3 7 8 15 8"/>
                  </svg>
                </span>
                <span class="button-text">‰øùÂ≠òÈÖçÁΩÆ</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- ÈÖçÁΩÆÁÆ°ÁêÜÈù¢Êùø -->
      <div class="config-management-panel" id="configManagementPanel" style="display: none;">
        <div class="panel-header">
          <h3 class="panel-title">ÈÖçÁΩÆÁÆ°ÁêÜ</h3>
          <button class="close-button" onclick="closeConfigManagement()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        
        <div class="panel-content">
          <div class="config-list" id="configList">
            <!-- Âä®ÊÄÅÁîüÊàêÁöÑÈÖçÁΩÆÂàóË°® -->
          </div>
          
          <div class="config-stats">
            <div class="stat-item">
              <span class="stat-label">ÊÄªÈÖçÁΩÆÊï∞:</span>
              <span class="stat-value" id="totalConfigs">0</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">Ê¥ªÂä®ÈÖçÁΩÆ:</span>
              <span class="stat-value" id="activeConfigs">0</span>
            </div>
          </div>
        </div>
      </div>

      <!-- ÂØºÂÖ•ÂØºÂá∫Èù¢Êùø -->
      <div class="import-export-panel" id="importExportPanel" style="display: none;">
        <div class="panel-header">
          <h3 class="panel-title" id="importExportTitle">ÂØºÂÖ•ÈÖçÁΩÆ</h3>
          <button class="close-button" onclick="closeImportExport()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
        </div>
        
        <div class="panel-content">
          <div class="import-export-content" id="importExportContent">
            <!-- Âä®ÊÄÅÁîüÊàêÁöÑÂÜÖÂÆπ -->
          </div>
        </div>
      </div>
    </main>

    <!-- Â∫ïÈÉ®Áä∂ÊÄÅÊ†è -->
    <footer class="app-footer">
      <div class="footer-content">
        <div class="status-text" id="footerStatus">Â∞±Áª™</div>
        <div class="footer-actions">
          <div class="connection-status" id="connectionStatus">
            <div class="status-dot offline"></div>
            <span>Êú™ËøûÊé•</span>
          </div>
        </div>
      </div>
    </footer>
  </div>
  
  <script type="module" src="popup.ts"></script>
</body>
</html>