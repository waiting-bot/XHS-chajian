目前项目遇到了几个严重的问题，需要你帮我修复。

请根据以下要求，对代码进行修改和优化：

任务 1：修复 content-script.js 的致命错误
问题描述： content-script.js 在小红书的单页应用（SPA）环境中会被多次注入，导致控制台报错 Uncaught SyntaxError: Identifier 'i' has already been declared。这个错误会阻塞后续所有逻辑，是导致数据采集失败的根源。

实现要求：

打开 src/content/content-script.js 文件。

在文件顶部，添加一个全局检查机制，确保脚本的核心逻辑只执行一次。

具体方法是：使用 if (window.hasRunXhsChajianContentScript) 来检查一个全局标记。

如果该标记已存在，则立即终止脚本执行。

如果不存在，则将该标记设置为 true (window.hasRunXhsChajianContentScript = true;)，然后继续执行文件内原有的所有代码。

请将该文件原有的全部代码都包裹在这个 if/else 结构中。

任务 2：增强后台脚本 (background.js) 的健壮性和错误处理
问题描述： 目前，即时飞书 API 调用失败，前端界面依然会提示“采集完成”，用户无法得知真实的失败原因。

实现要求：

打开 src/background/background.js 文件。

定位到调用飞书 API 的函数（通常是使用 fetch 的异步函数）。

使用 try...catch 结构完整包裹 API 请求和响应处理的逻辑。

在 fetch 之后，不仅要捕获网络层面的错误，还要检查飞书 API 返回的 JSON 数据中的 code 字段。如果 code 不等于 0，也视为一次失败的请求。

重构消息回传机制：

仅在 API 请求成功且 code === 0 时，向 popup 发送表示成功的消息，例如：{ success: true, message: '数据已成功写入飞书' }。

在任何错误情况下（catch 到错误，或 code !== 0），都向 popup 发送表示失败的消息，并附带错误信息，例如：{ success: false, error: '具体的错误原因' }。

在 popup 的 Vue 组件中，修改接收消息的逻辑，根据回传消息的 success 字段来决定显示“成功”提示还是“失败”提示（并将 error 内容展示给用户）。

任务 3：修复 popup 界面配置下拉框不更新的问题
问题描述： 在 popup 界面新增一个飞书配置并保存后，上方的“选择配置”下拉框不会自动刷新，内容为空，必须重启插件才能看到。

实现要求：

在 popup 的 Vue 组件中，定位到负责保存新配置到 chrome.storage.local 的函数。

这个保存操作是异步的，请确保使用 async/await。

关键点： 在 chrome.storage.local.set 调用成功之后，立刻再次调用从 chrome.storage.local.get 读取全部配置的函数。

将新读取到的完整配置列表，重新赋值给驱动下拉框渲染的那个 Vue 响应式变量（例如一个 ref 或 reactive 对象）。这样可以强制刷新视图。

同时，确保界面上那个手动的“刷新”按钮也绑定了相同的“重新读取配置并更新视图”的函数。

任务 4：将 popup 交互模式改为持久化窗口
问题描述： 当前的 popup 窗口在用户点击页面其他位置时会自动关闭，体验不佳。需要一个可以固定住的界面。

实现要求：

修改 manifest.json 文件，在 action 字段中，删除或注释掉 "default_popup": "popup.html" 这一行。

打开 src/background/background.js 文件。

添加一个新的事件监听器 chrome.action.onClicked.addListener((tab) => { ... });。

在该监听器内部，调用 chrome.windows.create API 来创建一个新窗口。

chrome.windows.create 的参数应设置为：

url: 'popup.html'

type: 'popup'

width: 400 (或你认为合适的宽度)

height: 600 (或你认为合适的高度)

最后，在 popup.html 或其 Vue 组件中，添加一个“关闭”按钮，并为它绑定 window.close() 的点击事件。

请一步步完成以上所有任务，确保代码的健壮性、响应性和用户体验得到提升。